<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>reveal.js</title>

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/white.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<script src="js/jquery-1.4.4.min.js"></script>

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement('link');
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName('head')[0].appendChild(link);
	</script>

	<script type="text/x-mathjax-config">
		MathJax.Hub.Config({ TeX: { extensions: ["color.js"] }});
	</script>

</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h2>Sequential Monte Carlo in Approximate Bayesian Computation</h2>
			</section>

			<section>
				<h2>Bayesian Inference</h2>

				<div style="position:relative; width:640px; height:480px; margin:0 auto;">

					<div class="fragment" width="640" height="480" style="position:absolute;top:0;left:0;" data-fragment-index="0">
						<ul>
							<li>$p(\boldsymbol{\theta}|\boldsymbol{y})\propto p(\boldsymbol{y}|\boldsymbol{\theta})p(\boldsymbol{\theta})$</li>
							<li>$\boldsymbol{\theta}$ are parameters of some model</li>
							<li>$\boldsymbol{y}$ is observed data
						</ul>
						<div class="fragment fade-in" width="640" height="480" style="position:absolute;top:0;left:0;" data-fragment-index="1">
							<div class="fragment fade-out" width="640" height="480" style="position:absolute;top:0;left:0;" data-fragment-index="2">
								<ul>
									<li>$p(\boldsymbol{\theta}|\boldsymbol{y})\propto \color{red} p(\boldsymbol{y}|\boldsymbol{\theta})\color{black}p(\boldsymbol{\theta})$</li>
									<li></li>
									<li></li>
									<li>
										<span style="color:red">Likelihood</span>
									</li>
								</ul>
							</div>
						</div>

						<div class="fragment fade-in" width="640" height="480" style="position:absolute;top:0;left:0;" data-fragment-index="2">
							<ul>
								<li>$p(\boldsymbol{\theta}|\boldsymbol{y})\propto \color{red} p(\boldsymbol{y}|\boldsymbol{\theta})\color{blue}p(\boldsymbol{\theta})$</li>
								<li></li>
								<li></li>
								<li>
									<span style="color:red">Likelihood</span>
								</li>
								<li>
									<span style="color:blue">Prior</span>: Prior knowledge</li>
							</ul>
						</div>
					</div>
			</section>

			<section>
				<h2>Posterior</h2>
				<ul>
					<li class="fragment">Potentially difficult to find distribution</li>
				</ul>
			</section>

			<section>
				<h2>MCMC methods</h2>
				<ul>
					<li class="fragment">Popular method for sampling from arbitrary distribution</li>
					<li class="fragment">Need to evaluate likelihood</li>
				</ul>
			</section>

			<section>
				<h2>Approximate Bayesian Computation</h2>
				<ul>
					<li class="fragment">Approximation to distribution without evaluating likelihood</li>
					<li class="fragment">Likelihood-free methods</li>
				</ul>
			</section>

			<section>
				<h2>Problems</h2>
				<ul>
					<li class="fragment">Finding statistics
						<ul>
							<li class="fragment">Ad-hoc</li>
							<li class="fragment">Not focus here</li>
						</ul>
					</li>

					<li class="fragment">Computational resources
						<ul>
							<li class="fragment">Method we present here requires many samples from approximation to likelihood</li>
						</ul>
					</li>
				</ul>
			</section>

			<section>
				<h2>Sequential Monte Carlo</h2>
				<ul>
					<li class="fragment">Idea is to split problem of sampling $w(\boldsymbol{x})=\frac{p(\boldsymbol{x})}{g(\boldsymbol{x})}$ into substeps</li>
					<li class="fragment">$w(\boldsymbol{x})=\frac{p(x_{1})p(x_{2}|x_{1})p(x_{3}|x_{1},x_{2})...p(x_{k}|x_{1},...,x_{k-1})}{g(x_{1})g(x_{2}|x_{1})g(x_{3}|x_{1},x_{2})...g(x_{k}|x_{1},...,x_{k-1})}$</li>
				</ul>
			</section>

			<section>
				<section>
					<h2>Weight degeneracy</h2>
					<ul>
						<li class="fragment">Weights will spread out</li>
						<li class="fragment">Small number of particles can dominate</li>
					</ul>
				</section>
				<section>
					<video width="600" height="600" controls>
						<source src="video/weight_plot_resample0.mp4" type="video/mp4"> Your browser does not support the video tag.
					</video>
				</section>
			</section>

			<section>
				<section>
					<h2>Possible remedy</h2>
					<ul>
						<li class="fragment">Introduce resampling step</li>
						<li class="fragment">Triggered by ESS</li>
						<li class="fragment">Our definition:$$\frac{1}{\sum_{i=1}^{n}w_{i}(\boldsymbol{x})^{2}}$$</li>
					</ul>
				</section>
				<section>
					<section>
						<video width="600" height="600" controls>
							<source src="video/weight_plot_resample05.mp4" type="video/mp4"> Your browser does not support the video tag.
						</video>
					</section>
				</section>
			</section>

			<section>
				<h2>SMC in ABC</h2>
				<ul>
					<li class="fragment">Focus is on an algorithm developed by Del Moral et. al.</li>
				</ul>
			</section>

			<section>
				<ul>
					<li class="fragment">Algorithm uses what is called an SMC sampler developed by Del Moral et. al.</li>
				</ul>
			</section>

			<section>
				<h2>Resampling schedule</h2>
				<div class="fragment">$\mathrm{ESS}(w(\boldsymbol{x}_{i}))=\alpha\mathrm{ESS}(w(\boldsymbol{x}_{i-1}))$</div>
				<img src="figures/epsilon_candidate_plot_1000_09_toy_example.png" class="fragment" />
			</section>

			<section>
				<section>
					<h2>Algorithm</h2>
				</section>

				<section>
					<!-- <img width="736" height="727" src="figures/smc_algorithm1.png"/> -->
					<img width="589" height="582" src="figures/smc_algorithm1.png" />
				</section>

				<section>
					<img src="figures/smc_algorithm2.png" />
				</section>

				<section>
					<img src="figures/smc_algorithm3.png" />
				</section>
</section>
				<section>
					<h1>Examples</h1>
				</section>

				<section>
					<section>
						<h2>Simple mixture</h2>
						<ul>
							<li>$p(\theta|x)\sim(\mathrm{N}(\theta,1)+\mathrm{N}(\theta,\frac{1}{100}))\mathrm{I}_{[-10,10]}(\theta)$</li>
							<li class="fragment">$d(x,y)=|x-y|$</li>
							<li class="fragment">Single observation at $y=0$</li>
						</ul>
					</section>

					<section>
						<h3>No replicates</h3>
						<video width="600" height="600" controls>
							<source src="video/configuration1_replicates.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>
					</section>

					<section>
						<h3>5 replicates</h3>
						<video width="600" height="600" controls>
							<source src="video/configuration2_replicates.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>
					</section>

					<section>
						<h3>20 replicates</h3>
						<video width="600" height="600" controls>
							<source src="video/configuration3_replicates.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>
					</section>
				</section>


				<section>

					<section>
						<h2>MA(2) process</h2>
						<ul>
							<li>Example used in Marin et. al. (2012)</li>
							<li class="fragment">$z_{t}=a_{t}-\theta_{1}a_{t-1}-\theta_{2}a_{t-2}$</li>
							<li class="fragment">The task is to provide estimates for $\boldsymbol{\theta}$</li>
							<li class="fragment">Prior is chosen to be uniform on region that makes the process invertible</li>
							<li class="fragment">There is a closed expression for the likelihood</li>
						</ul>
					</section>

					<section>
						<h2>Setups</h2>
						<ul>
							<li>Trying two different statistics</li>
							<li>In all cases a time series of length 100 is generated, and this is used as the observation</li>
						</ul>

					</section>

					<section>
						<h3>Autocovariance distance</h3>
						<ul>
							<li>Using measure of autocovariance as statistic</li>
							<li class="fragment">$d=\frac{1}{n}\left(\sum_{i=2}^{n}\left(x_{i}x_{i-1}\right)-\sum_{i=2}^{n}\left(y_{i}y_{i-1}\right)\right)^{2}\\ +\frac{1}{n}\left(\sum_{i=2}^{n}\left(x_{i}x_{i-2}\right)-\sum_{i=2}^{n}\left(y_{i}y_{i-2}\right)\right)^{2}$
							</li>
						</ul>
					</section>

					<section>
						<h3>Autocovariance distance</h3>
						<video width="600" height="600" controls>
							<source src="video/ma_autocovariance.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>
					</section>
				</section>


				<section>
					<h3>Raw distance function</h3>
					<ul>
						<li>$d=\sum_{i=1}^{n}\left(x_{i}-y_{i}\right)^{2}$</li>
					</ul>
				</section>

				<section>
					<section>
						<h3>Raw distance function</h3>
						<ul>
							<li>Same settings as in previous example</li>
						</ul>
						<video width="750" height="500" controls>
							<source src="video/ma_raw_distance.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>
					</section>

					<section>
						<h3>What happens when it gets stuck?</h3>
						<div class="fragment">
							Note: Data from a different example
							<img src="figures/epsilon_candidate_plot.png" />
							<img src="figures/distance_to_epsilon.png" />
						</div>
					</section>

					<section>
						<h3>Raw distance function</h3>
						<ul>
							<li>$\alpha=0.99$</li>
						</ul>
						<br/>

						<video width="750" height="500" controls>
							<source src="video/ma_raw_distance2.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>

					</section>

					<section>
						<h3>Raw distance function</h3>
						<ul>
							<li>$\alpha=0.9$, 5 replicates</li>
							<li class="fragment" style="color:red">Bug</li>
						</ul>
						<br/>

						<video width="750" height="500" controls>
							<source src="video/ma_raw_distance3.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>

					</section>

					<section>
						<h3>Raw distance function</h3>
						<ul>
							<li>$\alpha=0.9$, 5 replicates</li>
							<li>Fixed</li>
						</ul>
						<br/>

						<video width="750" height="500" controls>
							<source src="video/ma_raw_distance3_v2.mp4" type="video/mp4">Your browser does not support the video tag.
						</video>

					</section>

				</section>

				</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				math: {
					mathjax: 'https://cdn.mathjax.org/mathjax/latest/MathJax.js',
					// mathjax: 'http://localhost:8000/js/MathJax/MathJax.js',
					config: 'TeX-AMS_HTML-full' // See http://docs.mathjax.org/en/latest/config-files.html
				},


				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [{
						src: 'plugin/markdown/marked.js'
					}, {
						src: 'plugin/markdown/markdown.js'
					}, {
						src: 'plugin/notes/notes.js',
						async: true
					}, {
						src: 'plugin/highlight/highlight.js',
						async: true,
						callback: function() {
							hljs.initHighlightingOnLoad();
						}
					}, {
						src: 'plugin/math/math.js',
						async: true
					},
					// Zoom in and out with Alt+click
					{
						src: 'plugin/zoom-js/zoom.js',
						async: true
					}
				]
			});
		</script>
</body>

</html>
